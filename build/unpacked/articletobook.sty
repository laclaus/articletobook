%%
%% This is file `articletobook.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% articletobook.dtx  (with options: `package')
%% 
%% This is a generated file.
%% 
%% SVN keywords: $Revision$
%% 
%% Copyright (C) 2022 by Sebastien Laclau
%% 
%% This file may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License, either
%% version 1.3c of this license or (at your option) any later
%% version. The latest version of this license is in:
%% 
%% http://www.latex-project.org/lppl.txt
%% 
%% and version 1.3c or later is part of all distributions of LaTeX
%% version 2008 or later.
%% 
\NeedsTeXFormat{LaTeX2e}[2021/06/01]
\ProvidesPackage{articletobook}
[2022/02/10 v1.0.0
 Converts article based classes to book based classes]
\newif\if@mainmatter \@mainmattertrue
\newif\if@openright \@openrighttrue
\@twosidetrue
\RequirePackage{kvoptions}
\SetupKeyvalOptions{
    family = atob,
    prefix = atob@
}
\DeclareBoolOption[false]{undefrules}
\DeclareBoolOption[false]{fixstarredmarks}
\DeclareVoidOption{openright}{\@openrighttrue}
\DeclareVoidOption{openany}{\@openrightfalse}
\@twosidetrue
\DeclareVoidOption{twoside}{\@twosidetrue}
\DeclareVoidOption{oneside}{\@twosidefalse}
\DeclareBoolOption[true]{booklayout}
\DeclareComplementaryOption{originallayout}{booklayout}

\ProcessKeyvalOptions*
\ifatob@booklayout
    \input{bk1\@ptsize.clo}
\fi

\ifatob@undefrules
    \let\headrule\undefined
    \let\footrule\undefined
\fi
\RequirePackage[notocpart*,loadonly]{titlesec}
\RequirePackage{titletoc}
\RequirePackage[nopatches]{titleps}
\RequirePackage{xparse,etoolbox}
\if@twoside
    \renewpagestyle{headings}{
        \sethead[\thepage]%
                []%
                [\slshape\MakeUppercase{\ifnum\c@secnumdepth>\m@ne%
                    \if@mainmatter\if@noschapter%
                        \@chaptername\ \thechapter.\ %
                 \fi\fi\fi\bookchaptertitle}]%
        {\slshape\MakeUppercase{\ifnum\c@secnumdepth>\z@\if@nossection%
            \thesection.\ \fi\fi\sectiontitle}}%
        {}%
        {\thepage}
    }
\else
    \renewpagestyle{headings}{
        \sethead{\slshape\MakeUppercase{\ifnum\c@secnumdepth>\m@ne%
                    \if@mainmatter\@chaptername\ \thechapter.\ %
                    \fi\fi\bookchaptertitle}}%
                {}%
                {\thepage}
    }
\fi
\renewpagestyle{myheadings}{
    \renewcommand{\markright}[1]{\def\rightmark{##1}}
    \renewcommand{\markboth}[2]{\def\leftmark{##1}\def\rightmark{##2}}
    \sethead[\thepage]%
            []%
            [\slshape\leftmark]%
            {\slshape\rightmark}%
            {}%
            {\thepage}
}
\if@titlepage\else
\renewcommand{\maketitle}{}
\fi
\setcounter{secnumdepth}{2}
\newcounter {bookpart}
\newcounter {bookchapter}
\@addtoreset{section}{bookchapter}
\renewcommand \thebookpart     {\@Roman\c@bookpart}
\renewcommand \thebookchapter  {\@arabic\c@bookchapter}
\renewcommand \thesection      {\thebookchapter.\@arabic\c@section}
\renewcommand \thesubsection   {\thesection.\@arabic\c@subsection}
\renewcommand \thesubsubsection{\thesubsection.\@arabic\c@subsubsection}
\renewcommand \theparagraph    {\thesubsubsection.\@arabic\c@paragraph}
\renewcommand \thesubparagraph {\theparagraph.\@arabic\c@subparagraph}
\newcommand\frontmatter{%
    \if@openright
        \cleardoublepage
    \else
        \clearpage
    \fi
    \@mainmatterfalse
    \pagenumbering{roman}}
\newcommand\mainmatter{%
    \if@openright
        \cleardoublepage
    \else
        \clearpage
    \fi
    \@mainmattertrue
    \pagenumbering{arabic}}
\newcommand\backmatter{%
    \if@openright
        \cleardoublepage
    \else
        \clearpage
    \fi
    \@mainmatterfalse}
\titleclass{\bookpart}[-1]{page}
\titleclass{\bookchapter}{top}[\bookpart]
\titleclass{\section}{straight}[\bookchapter]
\titleclass{\subsection}{straight}[\section]
\titleclass{\subsubsection}{straight}[\subsection]
\titleclass{\paragraph}{straight}[\subsubsection]
\titleclass{\subparagraph}{straight}[\paragraph]
\titleformat{\bookpart}
    [display]
    {\centering\normalfont\huge\bfseries}
    {\partname\nobreakspace\thebookpart}
    {20pt}
    {\Huge}
\titlespacing*{\bookpart}{0pt}{0pt}{0pt}

\titleformat{\bookchapter}
    [display]
    {\normalfont\huge\bfseries\if@appendix%
        \gdef\@chaptername{\appendixname}\fi}
    {\@chaptername\ \thebookchapter}
    {20pt}
    {\Huge}
\titlespacing*{\bookchapter}{0pt}{50pt}{40pt}

\titleformat{\section}
    {\normalfont\Large\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}
    {\normalfont\large\bfseries}{\thesubsection}{1em}{}
\titleformat{\subsubsection}
    {\normalfont\normalsize\bfseries}{\thesubsubsection}{1em}{}
\titleformat{\paragraph}[runin]
    {\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titleformat{\subparagraph}[runin]
    {\normalfont\normalsize\bfseries}{\thesubparagraph}{1em}{}

\titlespacing*{\chapter}
    {0pt}{50pt}{40pt}
\titlespacing*{\section}
    {0pt}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}
\titlespacing*{\subsection}
    {0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
\titlespacing*{\subsubsection}
    {0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
\titlespacing*{\paragraph}
    {0pt}{3.25ex plus 1ex minus .2ex}{1em}
\titlespacing*{\subparagraph}
    {\parindent}{3.25ex plus 1ex minus .2ex}{1em}
\let\part\bookpart
\settitlemarks{bookchapter,section}
\newif\if@noschapter \@noschaptertrue
\NewDocumentCommand{\chapter}{s O{#3} m}{
    \IfBooleanTF{#1}{
        \@schapter{#2}{#3}
        \ifatob@fixstarredmarks\@noschapterfalse\else\@noschaptertrue\fi
    }{
        \@chapter{#2}{#3}
        \@noschaptertrue
    }
}
\NewDocumentCommand{\@schapter}{m m}{
    \bookchapter*{#2}

    \ifatob@fixstarredmarks\def\lastchaptermark{#1}\fi

    \chaptermark{\lastchaptermark}
}
\NewDocumentCommand{\@chapter}{m m}{
    \if@mainmatter
        \bookchapter[#1]{#2}
    \else
        \bookchapter*{#2}
        \addcontentsline{toc}{bookchapter}{#1}
    \fi
    \def\lastchaptermark{#1}
    \chaptermark{#1}
}
\let\oldsection\section
\newif\if@nossection \@nossectiontrue
\RenewDocumentCommand{\section}{s O{#3} m}{
    \IfBooleanTF{#1}{
        \@ssection{#2}{#3}
        \ifatob@fixstarredmarks\@nossectionfalse\else\@nossectiontrue\fi
    }{
        \@section{#2}{#3}
        \@nossectiontrue
    }
}
\NewDocumentCommand{\@ssection}{m m}{
    \oldsection*{#2}

    \ifatob@fixstarredmarks\def\lastsectionmark{#1}\fi

    \sectionmark{\lastsectionmark}
}
\NewDocumentCommand{\@section}{m m}{
    \oldsection[#1]{#2}

    \def\lastsectionmark{#1}
    \sectionmark{#1}
}
\newcommand{\chaptermark}[1]{\bookchaptermark{#1}}
\newcommand{\thechapter}{\thebookchapter}
\undef{\abstract}
\undef{\endabstract}
\renewenvironment{titlepage}
    {%
        \cleardoublepage
        \if@twocolumn
        \@restonecoltrue\onecolumn
        \else
        \@restonecolfalse\newpage
        \fi
        \thispagestyle{empty}%
        \setcounter{page}\z@
    }%
    {\if@restonecol\twocolumn \else \newpage \fi
    }
\@addtoreset{equation}{bookchapter}
\renewcommand{\theequation}{\ifnum \c@bookchapter>\z@%
    \thebookchapter.\fi \@arabic\c@equation}
\newif\if@appendix \@appendixfalse
\renewcommand{\appendix}{
    \par
    \setcounter{bookchapter}{0}
    \setcounter{section}{0}
    \@appendixtrue
    \gdef\thebookchapter{\@Alph\c@bookchapter}
}
\@addtoreset{figure}{bookchapter}
\renewcommand{\thefigure}{\ifnum \c@bookchapter>\z@%
    \thebookchapter.\fi \@arabic\c@figure}
\@addtoreset{table}{bookchapter}
\renewcommand{\thetable}{\ifnum \c@bookchapter>\z@%
    \thebookchapter.\fi \@arabic\c@table}
\setcounter{tocdepth}{2}
\renewcommand\tableofcontents{%
    \if@twocolumn
        \@restonecoltrue\onecolumn
    \else
        \@restonecolfalse
    \fi
    \chapter*{\contentsname}%
    \chaptermark{\contentsname}
    \vspace{-40pt}
    \@starttoc{toc}%
    \if@restonecol\twocolumn\fi
}

\contentsmargin{2.55em}

\titlecontents{bookpart}
    [1.6em]
    {\addvspace{3.25em}\bfseries\large}
    {\contentslabel{1.4em}}
    {\hspace*{0em}}
    {\normalsize\hfill\contentspage{\large}}

\titlecontents{bookchapter}
    [1.5em]
    {\addvspace{1em}\bfseries}
    {\contentslabel{1.5em}}
    {\hspace*{-1.5em}}
    {\titlerule*[1pc]{}\contentspage}

\titlecontents{section}
    [3.8em]
    {}
    {\contentslabel{2.3em}}
    {\hspace*{-1.5em}}
    {\titlerule*[1pc]{.}\contentspage}

\titlecontents{subsection}
    [7.1em]
    {}
    {\contentslabel{3.2em}}
    {\hspace*{-2.3em}}
    {\titlerule*[1pc]{.}\contentspage}

\titlecontents{subsubsection}
    [9.3em]
    {}
    {\contentslabel{4.1em}}
    {\hspace*{-3.2em}}
    {\titlerule*[1pc]{.}\contentspage}

\titlecontents{paragraph}
    [12.3em]
    {}
    {\contentslabel{5em}}
    {\hspace*{-4.1em}}
    {\titlerule*[1pc]{.}\contentspage}

\titlecontents{subparagraph}
    [14.3em]
    {}
    {\contentslabel{6em}}
    {\hspace*{-5em}}
    {\titlerule*[1pc]{.}\contentspage}
\renewcommand\listoffigures{%
    \if@twocolumn
        \@restonecoltrue\onecolumn
    \else
        \@restonecolfalse
    \fi
    \chapter*{\listfigurename}%
    \chaptermark{\listfigurename}
    \vspace{-40pt}
    \@starttoc{lof}%
    \if@restonecol\twocolumn\fi
}
\renewcommand\listoftables{%
    \if@twocolumn
        \@restonecoltrue\onecolumn
    \else
        \@restonecolfalse
    \fi
    \chapter*{\listtablename}%
    \chaptermark{\listtablename}
    \vspace{-40pt}
    \@starttoc{lot}%
    \if@restonecol\twocolumn\fi
}
\renewenvironment{thebibliography}[1]
{\chapter*{\bibname}%
    \chaptermark{\bibname}
    \list{\@biblabel{\@arabic\c@enumiv}}%
    {\settowidth\labelwidth{\@biblabel{#1}}%
        \leftmargin\labelwidth
        \advance\leftmargin\labelsep
        \@openbib@code
        \usecounter{enumiv}%
        \let\p@enumiv\@empty
        \renewcommand\theenumiv{\@arabic\c@enumiv}}%
    \sloppy
    \clubpenalty4000
    \@clubpenalty \clubpenalty
    \widowpenalty4000%
    \sfcode`\.\@m}
{\def\@noitemerr
    {\@latex@warning{Empty `thebibliography' environment}}%
    \endlist}
\renewenvironment{theindex}
{\if@twocolumn
    \@restonecolfalse
    \else
    \@restonecoltrue
    \fi
    \twocolumn[\chapter*{\indexname}\chaptermark{\indexname}]%
    \thispagestyle{plain}\parindent\z@
    \parskip\z@ \@plus .3\p@\relax
    \columnseprule \z@
    \columnsep 35\p@
    \let\item\@idxitem}
{\if@restonecol\onecolumn\else\clearpage\fi}
\def\lastsectionmark{}
\def\lastchaptermark{}
\newcommand{\bibname}{Bibliography}
\newcommand{\chaptername}{Chapter}
\newcommand{\@chaptername}{\chaptername}
\pagestyle{headings}
\endinput
%%
%% End of file `articletobook.sty'.
